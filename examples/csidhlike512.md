# CDISH-like 512-bit prime

In this computation, the discriminant is the unique 512-bit prime:
```
D = 1 - 4 p_1 ... p_k
```
where `p_i` are distinct primes less than 400. More precisely:
```
D = 1 - 2 * A034386[384] / 103
```

The number -D is a 512-bit prime with 155 digits
```
|D| = 12788631075545042019885814323604251970891115894137269915496103558006547455463485064294450611974172171025784769822046766639132099243976012346853040372715419
```

This number is slightly larger than the previous record computation
([Csi-Fish](https://eprint.iacr.org/2019/498), 2019).

The class number formula can be used to obtain a rough approximation:
```
h ~= 1.2197e+77
```

The actual class number is

```
h = 121974608592893413628195212803433755492657491792765235257708213172076221358737
```

It was computed in July 2025 in 41 days using cloud GPU resources.
The implementation was commit e61c7902200a1a5c064b2a552d69aed6e614c137
customized to select algorithm parameters.

## Sieving parameters

This computation was done without the SIQS initialization optimization
from [Kleinjung, Quadratic Sieving](https://www.ams.org/journals/mcom/2016-85-300/S0025-5718-2015-03058-0/S0025-5718-2015-03058-0.pdf)

* the sieving bound was B1=7500000 (254219 primes)
* the bound for large primes was 60 B1 = 600M
* polynomials had leading coefficients A with 12 factors (2048 polynomials each)
* each polynomial was sieved over an interval of size 983040 (60 segments of 16kB)
* the threshold for reporting sieve results was 184 bits (3 large primes allowed)

The sieving step ran on a computer with 4 AMD Radeon Pro VII GPUs
with a dual Intel Xeon Silver 4108 CPU, using Vulkan compute shaders
through the open-source RADV driver in [Mesa](https://mesa3d.org/).

* The average sieving speed was 164G/s (81.6 A values per second)
* Relations were found once every 92.4 billion elements (1.78 relations per second)
* 5677690 relations were found involving 6600725 primes
* 20669 relations have no large prime
* 462178 relations have 1 large prime
* 3344567 relations have 2 large primes
* 1850275 relations have 3 large primes
* 1 relation has 4 large primes
* The process took 37 days and sieved a total region of size `524 Ã— 10^15`.
* The cost of cloud resources was 49 USD

## Partial elimination of relations

This step has a negligible cost and was run on an ordinary personal computer.

The resulting matrix has 329361 columns, 329398 rows (relations)
with an average number of 91 coefficients per row (largest coefficient is 25).

## Computation of class number

This computation was done using the ordinary Wiedemann algorithm on multiple
word-sized moduli simultaneously. This step ran on a computer with a dual
Intel Xeon E5-2686 v4 CPU and 4 Nvidia RTX 5070 GPU. Multiple CPU threads (8)
were used to maximize GPU occupancy. The implementation used the standard
Vulkan driver from NVIDIA.

* Size of moduli for small prime determinants was 56 bits
* The computation kernel was `spmv_multi.comp` with 32 moduli and 16 rows per workgroup
* The average equivalent throughput was about 28200 matrix-vector multiplications per second
* First determinant had size 420854 bits and was computed in 177161s (using 7584 moduli)
* The first determinant provides a small class number factor (3) but the next prime
  factor 951476957 was not a factor of the class number. No other small factor was found
  by a quick ECM run.
* Second determinant had size 420850 bits and was computed in 177067s (using 7584 moduli)
* The GCD of determinants was 6h=731847651557360481769171276820602532955944950756591411546249279032457328152422
* Cost of cloud resources was 16 USD

## Determination of group structure

This step was run on the same host as linear algebra: implementation
is not parallel and used a single CPU core and a single GPU.

For a basis of 329361 primes, the structure modulo factors of `h`
(3, 94209746229261188741, 270058697035404939021075337, 1598064030856906607322012251687)
was computed in 15 minutes of CPU times and 3x14 minutes of GPU time (RTX 5070).

The class group is cyclic, and `[3]` is a group generator. The coordinates
of the smallest prime ideals are:

```
3 1
5 49005777675014812601405541526188918231682136841027344994296361550973339272992
7 20910206023773519266376189922889172793482684042661384555763063106062230616170
11 20653020844392799801265469118193840332545182811755256788939044429095077855386
13 36713588421578328013606933468526562398963030319172605127903191157374771220655
17 16409611774765242695764931206321811825202247518239057487678573509177760523010
19 46041672902135851763816501757894940188108754495676138232934259751350229868858
23 46910402491678468694321290425337117625712131683774224275433973216945047423200
29 93342141802819105477530624270514291402843574234835324242641174399902510522718
31 56964739030176450856552235617028747510993633264080555830010138644126835663595
...
10000103 48640416359735705587894492041721262159237380571385042418678179175466171350837
10000121 100304159271702732183708136956931402144145397242698057396466075444927015131451
10000139 53027603267495722052823762992534702610807594293370329387158176043115786565545
10000189 26565769391021131323046477654285806227379632870903251761291867688571876319412
10000223 33143094220779872777865931518003190797846887159411517983428997484421100093965
```

Using all relations, coordinates can be computed for 3978145 prime ideals.

```
599994371 87937814468909290286581568114819529100639128253059656747263760827134115343559
599994959 25716998091834075857889931735556465467316780053782353398357192859389745888173
599996053 111045704741992928922455909883598225543150235556187468649536515202158819652472
599997007 104366715147290117854209816070744603585386514010319462903315011832208460601215
599997109 65420855213332500135562011574537341779036675400649553378497031135848234314061
599998937 73989896291069322597045760948657842102906730664931636429023633619713021374577
599998939 114777182827490668692654599520878072362327208984763655532648393121084222888834
599998981 104110355720446131797636273708824784164879418221168128645377050663036335937832
599999429 68667005200885833568168835668538883783780222278051559732938566432424308238317
599999467 19688273403907168655500575690851633734223246521903571383834597560541590213434
```

## Computation of coordinates of an arbitrary ideal

The precomputation allows determination of coordinates for arbitrary prime ideals
in a few seconds.

For example:
```
# next_prime(10**199)
l = 10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000153

# after quick CPU sieve
[l] = 17^-2 23^2 127^-1 229^-1 359^1 877^-1 5347^1 524353^-1 122497^1 138157^-1 4561163^-1 46998163^-1 7186307^1 235873262392661429^-1 118371228738060539^1

# after GPU sieve
[235873262392661429] = [-3, -3, -5, -5, 366437, 467209, -1044559, 1370219,
-1730471, 3092717, -101, 16691, 24181, 174091, -117797, 67667773, 10478089,
-160952171, 76963, 77017, -77269, -77491, -77549, 77557, 77681, -77747, 77849,
77893, 77983]

# after GPU sieve
[118371228738060539] = [7687, -5, -5, -5, 7, 7, 7, 7, -173, -211, -1297,
-12689, 12907, -23291, -69061, -98419, -307009, 340337, 1528103, 3921721,
-5218667, 17, 59, 149, 30978817, 82073, -82241, 82463, -82483, -82499, 82507,
-82699, 82763, -82793, 82813, 82837]

# final decomposition
[l] = 3^2 5^-1 7^4 17^-1 23^2 59^1 101^1 127^-1 149^1 173^-1 211^-1 229^-1
359^1 877^-1 1297^-1 5347^1 7687^1 12689^-1 12907^1 16691^-1 23291^-1 24181^-1
69061^-1 76963^-1 77017^-1 77269^1 77491^1 77549^1 77557^-1 77681^-1 77747^1
77849^-1 77893^-1 77983^-1 82073^1 82241^-1 82463^1 82483^-1 82499^-1 82507^1
82699^-1 82763^1 82793^-1 82813^1 82837^1 98419^-1 117797^1 122497^1 138157^-1
174091^-1 307009^-1 340337^1 366437^-1 467209^-1 524353^-1 1044559^1 1370219^-1
1528103^1 1730471^1 3092717^-1 3921721^1 4561163^-1 5218667^-1 7186307^1
10478089^-1 30978817^1 46998163^-1 67667773^-1 160952171^1
```

The following identity is found:
```
[l] = [3]^-269818730037819708488014272650872792009601883812039707535278932118294167194785
```
